<%= turbo_stream.update dom_id(@champ, :rows) do %>
  <% @champ.row_ids.each.with_index(1) do |row_id, row_number| %>
    <%= fields_for @champ.input_name, @champ do |form| %>
      <%= render EditableChamp::RepetitionRowComponent.new(form: form, dossier: @champ.dossier, champ: @champ, row_id: row_id, row_number: row_number, seen_at: nil, expanded: row_number == 1) %>
    <% end %>
  <% end %>
<% end %>

<% if @deleted_row_number %>
  <%= turbo_stream.append dom_id(@champ, :deletion_announcement), delay: 1000 do %> <%# the delay is to ensure there is not conflict with the focus %>
    <%= t('editable_champ.repetition_component.deleted', row_number: @deleted_row_number, libelle: @champ.row_libelle) %>
  <% end %>
<% end %>

<%= turbo_stream.focus @to_focus %>
